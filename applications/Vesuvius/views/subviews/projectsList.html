<ul class="projectsList">
    {{for project in projects:}}
        <li class="projectsListItem">
            <div class="projInfoCol">
                {{=H4(project.title, _id=project.title)}}
                {{if 'dash' in locals() and dash is True:}}
                    <div class="alert alert-info dashNotification">
                        Project is {{=B(project.state)}}. {{=project.compDocs}}/{{=project.totalDocs}} documents completed.
                    </div>
                {{pass}}
                {{=DIV(project.description)}}
            </div>
            <div class="projImgCol">
                {{=IMG(_src=URL('default', 'getImage', args=[project.image]), _alt=project.imageAlt)}}
                {{srContext = SPAN(' ' + project.title, _class='sr-only')}}
                {{viewClass = 'btn btn-project'}}
                {{
                    if 'dash' not in locals():
                        viewClass += ' btn-primary'
                        pass
                }}
                {{=DIV(A('View', srContext, _href=URL('project', 'view', vars=dict(id=project.id)), _class=viewClass))}}
                {{
                    if 'dash' in locals() and dash is True:
                        action = 'Open'
                        if project.state == 'open':
                           action = 'Close'
                        pass

                        actionText = action
                        actionBtnClass = 'btn btn-project'

                        if action == 'Open' or project.transcriptionCount > 0:
                            if request.vars.created is not None and project.title == request.vars.created:
                                actionBtnClass += ' btn-success'
                            pass
                            actionBtn = A(actionText, srContext, _href=URL(vars=dict(id=project.id, action=action)), _class=actionBtnClass)
                            if action == 'Close':
                                =actionBtn
                            elif project.unCompleteDocCount > 0:
                                =actionBtn
                            pass
                        else:
                            =A(actionText, srContext, _href=URL(vars=dict(id=project.id, action=action)), _class=actionBtnClass, _disabled=True, _title='You cannot close the project until someone has made a transcription.')
                        pass


                        if action == 'Open':
                            =A('Review', srContext, _href=URL('project', 'review', vars=dict(id=project.id)), _class='btn btn-project')
                        else:
                            =A('Review', srContext, _href=URL('project', 'review', vars=dict(id=project.id)), _class='btn btn-project', _disabled=True, _title='You cannot review a project until you close it.')
                        pass
                    pass
                }}
            </div>
        </li>
    {{pass}}
</ul>